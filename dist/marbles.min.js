!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.marbles=t():n.marbles=t()}(this,function(){return function(n){function t(r){if(e[r])return e[r].exports;var o=e[r]={exports:{},id:r,loaded:!1};return n[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var e={};return t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){"use strict";function r(n){if(n&&n.__esModule)return n;var t={};if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t.default=n,t}function o(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},u=e(1),c=r(u),f=function n(t){function e(n,t){return n.replace(w,function(n){return t[n.replace(":","")]})}function r(n,t){var e=n.match(new RegExp(w.source,"g"))||[];return(t.match(A)||[]).reduce(function(n,t,r){return n[e[r].replace(":","")]=t,c.assign(c.emptyObject(),n)},c.emptyObject())}function u(n){var t=n.replace(new RegExp(w.source,"g"),A.source);return new RegExp(t)}function f(n,t){for(var e=t;e;){if(e.id===n)return e;e=e.next}return null}function a(n,t){for(var e=c.emptyObject(),r=c.isObject(t)?t:{data:{}},o=n;o&&o!==r;)c.assign(e,o.data),o=o.next;return c.assign(e,r.data)}function s(n,t){var r=t[n];return c.assign(c.emptyObject(),r,{id:n,segment:e(r.segment,r.data),next:null})}function l(n,t,e){function r(t,e,o){var i=o[e];(t===e||i.dependency===t||n)&&(i.active=!1,i.data=c.emptyObject()),i.children.forEach(function(n){return r(t,n,o)})}var o=c.cloneDeep(e);return r(t,t,o),o}function p(n,t,e){function r(n,e,i){var u=o[e],c=o[n];return e===n&&i?(c.active=!0,c.data=t,!0):!(e===n&&!i)&&u.children.reduce(function(t,e){return r(n,e,t)},i||e===c.dependency)}var o=c.cloneDeep(e),i=c.keys(o).filter(function(t){return o[t].children.indexOf(n)!==-1}),u=r(n,"root",!1);return u?i.reduce(function(t,e){return t[e].children.filter(function(t){return t!==n}).reduce(function(n,t){return l(!0,t,n)},t)},o):o}function d(n,t){for(var e=c.cloneDeep(t),r=e,o=void 0,i=!1;r;)i=i||r.id===n.dependency,o=r,r=r.next;return i&&(o.next=c.cloneDeep(n)),e}function y(n,t){function e(n,t,o,i){var f=i[t];return f.children.reduce(function(t,f){var a=i[f],s=t,l=n.match(u(a.segment))||[],d=l.index?l.index+l[0].length:0;return o[f]?s:(o[f]=!0,l.length>0&&(i[a.dependency]||c.emptyObject()).active&&(s=p(f,r(a.segment,c.arrayHead(l)),i)),e(n.substr(d),f,o,s))},i)}var o=c.cloneDeep(t);return e(n,"root",{},o)}function h(n){return y(n,E)}function v(n){return c.listReduce(function(n,t){return t.segment?""+n+t.segment+"/":n},"#",n)}function b(n,t,e,r){var o=n[t],i=s(t,n),u=o.active?d(i,e):c.cloneDeep(e);return o.children.reduce(function(t,e){return r[e]?t:(r[e]=!0,b(n,e,t,r))},u)}function m(n){var t=c.peek(R);return t&&JSON.stringify(t)===JSON.stringify(n)||R.push(n),n}function g(n){return n?b(n,"root",s("root",n),c.emptyObject()):null}function x(n,t){return c.listReduce(function(n,e){return f(e.id,t)?n:n.concat(e)},[],n)}function O(n,t,e){var r=g(t),o=g(e),i=x(r,o),u=x(o,r);i.forEach(function(t){var e=t.id;n[e].forEach(function(n){n.removed()})}),u.forEach(function(t){n[t.id].forEach(function(n){n.inserted(a(o,t))})})}function j(n,t,e){var r=e;if(!c.isString(t)||!E[t])return null;(null===e||"object"!==("undefined"==typeof e?"undefined":i(e))||e instanceof Array)&&(r=c.emptyObject());var o=h(S.location.hash),u=void 0;return u=n?p(t,r,o):l(!1,t,o),S.location.hash=v(g(u)),this}var S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;o(this,n);var E=t,w=/:[a-zA-Z]+(?=\/?)/,A=/\d+(?=\/?)/,D=c.keys(E).reduce(function(n,t){return n[t]=[],n},c.emptyObject()),R=[];this.subscribe=function(n){if(!c.isObject(n))return!1;var t=c.keys(n).filter(function(n){return!!D[n]});return 0!==t.length&&(t.forEach(function(t){var e=n[t];D[t].push({inserted:e.inserted||c.noop,removed:e.removed||c.noop})}),!0)},this.unsubscribe=function(n,t,e){if(!(c.isString(n)&&c.isString(t)&&c.isFunction(e)&&D[n]))return!1;var r=D[n].filter(function(n){return n[t]===e});return c.pull(r,D[n])},this.insert=function(n,t){return j.call(this,!0,n,t)},this.remove=function(n){return j.call(this,!1,n)},this.getData=function(){return a(g(h(S.location.hash)))},this.step=function(){var n=S.location.hash,t=h(n);return O(D,R.pop(),t),m(t),S.history.replaceState(c.emptyObject(),"",v(g(t))),this};var k=this.step.bind(this);this.start=function(){return S.addEventListener("hashchange",k),this},this.stop=function(){return S.removeEventListener("hashchange",k),this}};t.default=f},function(n,t){"use strict";function e(){return Object.create(null)}function r(n){return"object"===("undefined"==typeof n?"undefined":O(n))&&null!==n&&!(n instanceof Array)}function o(n){return n instanceof Array}function i(n){return"string"==typeof n}function u(n){return"function"==typeof n}function c(n){return Object.keys(n)}function f(n){return JSON.parse(JSON.stringify(n))}function a(){for(var n=arguments.length,t=Array(n),e=0;e<n;e++)t[e]=arguments[e];return Object.assign.apply(this,t)}function s(n){if("undefined"!=typeof n&&n instanceof Array)return n[0]}function l(n,t){return n.map(function(n){for(var e=t.indexOf(n),r=[];e!==-1;)r=r.concat(t.splice(e,1)),e=t.indexOf(n);return r}).reduce(function(n,t){return n.concat(t)},[]).reduce(function(n,t){return n.indexOf(t)!==-1?n:n.concat(t instanceof Array?[t]:t)},[])}function p(n,t){var e=t.slice();return l(n,e),e}function d(n){return n&&n instanceof Array?n[n.length-1]||null:null}function y(){}function h(n){return null===n||r(n)&&"object"===O(n.next)}function v(n){if(!h(n))throw new TypeError("listForEach requires a list! Lists are objects with a `next` property.")}function b(n,t){v(t);for(var e=t,r=0;e;)n(e,r),e=e.next,r+=1}function m(n,t){var e=[];return b(function(t,r){e.push(n(t,r))},t),e.reduceRight(function(n,t){return a({},t,{next:n})},null)}function g(n,t,e){return function n(t,e,r,o){return null===r?e:(v(r),n(t,t(e,r,o),r.next,o+1))}(n,t,e,0)}function x(n,t){if(!o(n))throw new TypeError("batchAsyncResults() expects an array of functions as the first parameter.");var e=0,r=[];n.forEach(function(o){o(function(o){e+=1,r.push(o),e===n.length&&t(r)})})}Object.defineProperty(t,"__esModule",{value:!0});var O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n};t.emptyObject=e,t.isArray=o,t.isObject=r,t.isFunction=u,t.isString=i,t.isList=h,t.listForEach=b,t.listMap=m,t.listReduce=g,t.batchAsyncActions=x,t.noop=y,t.keys=c,t.peek=d,t.cloneDeep=f,t.assign=a,t.arrayHead=s,t.pull=l,t.without=p}])});
//# sourceMappingURL=marbles.min.js.map