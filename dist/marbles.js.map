{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 09948e4737608284b36d","webpack:///./src/marbles.js","webpack:///./src/util.js"],"names":["Marbles","routingGraph","win","window","IMMUTABLE_GRAPH","DYNAMIC_SEGMENT_REGEX","DIGIT_SEGMENT_REGEX","observers","reduce","obj","key","graphStack","expandSegment","segment","data","replace","segmentKey","extractSegmentData","templateSegment","segmentWithData","dynamicSegments","match","RegExp","source","value","index","segmentToRegex","regexed","findListNode","nodeId","list","next","id","chainData","upToNode","stop","graphNodeToListNode","graph","graphNode","deactivateGraphNode","force","immutableGraph","recDeactivate","target","current","g","curr","dependency","active","children","forEach","childId","activateGraphNode","parents","filter","indexOf","dfsActivate","searchId","currentId","dependencyMet","search","depMet","activated","parentId","retG","appendNode","node","head","clonedHead","last","parseHash","hashRoute","routeGraph","recParse","hash","rootId","visitedNodes","root","child","newG","matches","substrIndex","length","substr","newGraph","buildGraph","listToHashRoute","str","graphToLinkedList","listHead","nextListNode","newHead","logGraph","lastGraph","JSON","stringify","push","graphToList","notifyObservers","obsObj","oldGraph","oldListHead","newListHead","missing","nxt","arr","routeId","obs","removed","observerArray","i","inserted","insertOrRemove","insert","dataToUse","Array","location","subscribe","subscriptions","matchingKeys","sub","unsubscribe","route","event","handler","matchingObservers","call","remove","getData","step","originalHash","pop","history","replaceState","listener","bind","start","addEventListener","removeEventListener","emptyObject","Object","create","isObject","any","isString","isFunction","keys","cloneDeep","parse","assign","args","apply","arrayHead","array","undefined","pull","values","map","val","results","concat","splice","returnArray","subArray","without","newArray","slice","peek","noop"],"mappings":"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","file":"marbles.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"marbles\"] = factory();\n\telse\n\t\troot[\"marbles\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 09948e4737608284b36d","import {\n  pull,\n  isString,\n  isFunction,\n  emptyObject,\n  noop,\n  keys,\n  cloneDeep,\n  assign,\n  arrayHead,\n  isObject,\n  peek\n} from './util.js';\n\nexport default class Marbles {\n  constructor(routingGraph, win = window) {\n    const IMMUTABLE_GRAPH = routingGraph;\n    const DYNAMIC_SEGMENT_REGEX = /:[a-zA-Z]+(?=\\/?)/;\n    const DIGIT_SEGMENT_REGEX = /\\d+(?=\\/?)/;\n    const observers = keys(IMMUTABLE_GRAPH).reduce((obj, key) => {\n      obj[key] = [];\n      return obj;\n    }, emptyObject());\n    const graphStack = [];\n\n    // Private methods\n    function expandSegment(segment, data) {\n      return segment.replace(\n        DYNAMIC_SEGMENT_REGEX,\n        segmentKey => data[segmentKey.replace(':', '')]\n      );\n    }\n\n    function extractSegmentData(templateSegment, segmentWithData) {\n      const dynamicSegments = templateSegment.match(\n        new RegExp(DYNAMIC_SEGMENT_REGEX.source, 'g')\n      ) || [];\n      return (segmentWithData.match(DIGIT_SEGMENT_REGEX) || []).reduce((data, value, index) => {\n        data[dynamicSegments[index].replace(':', '')] = value;\n        return assign(emptyObject(), data);\n      },\n        emptyObject()\n      );\n    }\n\n    function segmentToRegex(segment) {\n      // It just got weird\n      const regexed = segment.replace(\n        new RegExp(DYNAMIC_SEGMENT_REGEX.source, 'g'),\n        DIGIT_SEGMENT_REGEX.source\n      );\n      return new RegExp(regexed);\n    }\n\n    function findListNode(nodeId, list) {\n      let next = list;\n      while (next) {\n        if (next.id === nodeId) {\n          return next;\n        }\n        next = next.next;\n      }\n      return null;\n    }\n\n    function chainData(list, upToNode) {\n      const data = emptyObject();\n      const stop = isObject(upToNode) ? upToNode : { data: {} };\n      let next = list;\n      while (next && next !== stop) {\n        assign(data, next.data);\n        next = next.next;\n      }\n      return assign(data, stop.data);\n    }\n\n    function graphNodeToListNode(id, graph) {\n      const graphNode = graph[id];\n      return assign(emptyObject(), graphNode, {\n        id,\n        segment: expandSegment(graphNode.segment, graphNode.data),\n        next: null,\n      });\n    }\n\n    function deactivateGraphNode(force, nodeId, immutableGraph) {\n      const graph = cloneDeep(immutableGraph);\n      function recDeactivate(target, current, g) {\n        const curr = g[current];\n        if (target === current || curr.dependency === target || force) {\n          curr.active = false;\n          curr.data = emptyObject();\n        }\n        curr.children.forEach(childId => recDeactivate(target, childId, g));\n      }\n      recDeactivate(nodeId, nodeId, graph);\n      return graph;\n    }\n\n    function activateGraphNode(nodeId, data, immutableGraph) {\n      const graph = cloneDeep(immutableGraph);\n      const parents = keys(graph).filter(key => graph[key].children.indexOf(nodeId) !== -1);\n      function dfsActivate(searchId, currentId, dependencyMet) {\n        const curr = graph[currentId];\n        const search = graph[searchId];\n        if (currentId === searchId && dependencyMet) {\n          search.active = true;\n          search.data = data;\n          return true;\n        }\n        else if (currentId === searchId && !dependencyMet) {\n          return false;\n        }\n        return curr.children.reduce(\n          (depMet, childId) => dfsActivate(searchId, childId, depMet),\n          dependencyMet || currentId === search.dependency\n        );\n      }\n\n      const activated = dfsActivate(nodeId, 'root', false);\n      if (activated) {\n        // deactivate immediate siblings\n        return parents.reduce((g, parentId) =>\n          g[parentId].children.filter(id => id !== nodeId).reduce((retG, childId) =>\n            deactivateGraphNode(true, childId, retG),\n            g),\n          graph);\n      }\n      return graph;\n    }\n\n    function appendNode(node, head) {\n      const clonedHead = cloneDeep(head);\n      let next = clonedHead;\n      let last;\n      let dependencyMet = false;\n      while (next) {\n        dependencyMet = dependencyMet || next.id === node.dependency;\n        last = next;\n        next = next.next;\n      }\n      if (dependencyMet) {\n        last.next = cloneDeep(node);\n      }\n      return clonedHead;\n    }\n\n    function parseHash(hashRoute, routeGraph) {\n      function recParse(hash, rootId, visitedNodes, graph) {\n        const root = graph[rootId];\n        return root.children.reduce((g, childId) => {\n          const child = graph[childId];\n          let newG = g;\n          const matches = hash.match(segmentToRegex(child.segment)) || [];\n          const substrIndex = matches.index ? matches.index + matches[0].length : 0;\n          if (visitedNodes[childId]) {\n            return newG;\n          }\n          visitedNodes[childId] = true;\n          if (matches.length > 0 && (graph[child.dependency] || emptyObject()).active) {\n            newG = activateGraphNode(\n              childId,\n              extractSegmentData(child.segment, arrayHead(matches)),\n              graph\n            );\n          }\n          return recParse(hash.substr(substrIndex), childId, visitedNodes, newG);\n        }, graph);\n      }\n      const newGraph = cloneDeep(routeGraph);\n      return recParse(hashRoute, 'root', {}, newGraph);\n    }\n\n    function buildGraph(hash) {\n      return parseHash(hash, IMMUTABLE_GRAPH);\n    }\n\n    function listToHashRoute(head) {\n      let str = '#';\n      let next = head;\n      while (next) {\n        if (next.segment) {\n          str += `${next.segment}/`;\n        }\n        next = next.next;\n      }\n      return str;\n    }\n\n    function graphToLinkedList(graph, rootId, listHead, visitedNodes) {\n      const root = graph[rootId];\n      const nextListNode = graphNodeToListNode(rootId, graph);\n      const newHead = root.active ? appendNode(nextListNode, listHead) : cloneDeep(listHead);\n\n      return root.children.reduce(\n        (head, childId) => {\n          if (visitedNodes[childId]) {\n            return head;\n          }\n          visitedNodes[childId] = true;\n          return graphToLinkedList(graph, childId, head, visitedNodes);\n        },\n        newHead\n      );\n    }\n\n    function logGraph(newGraph) {\n      const lastGraph = peek(graphStack);\n      if (!lastGraph || JSON.stringify(lastGraph) !== JSON.stringify(newGraph)) {\n        graphStack.push(newGraph);\n      }\n      return newGraph;\n    }\n\n    function graphToList(graph) {\n      if (!graph) {\n        return null;\n      }\n      return graphToLinkedList(graph, 'root', graphNodeToListNode('root', graph), emptyObject());\n    }\n\n    function notifyObservers(obsObj, oldGraph, newGraph) {\n      const oldListHead = graphToList(oldGraph);\n      const newListHead = graphToList(newGraph);\n      const missing = (() => {\n        let nxt = oldListHead;\n        const arr = [];\n        while (nxt) {\n          if (!findListNode(nxt.id, newListHead)) {\n            arr.push(nxt.id);\n          }\n          nxt = nxt.next;\n        }\n        return arr;\n      })();\n      missing.forEach((routeId) => {\n        obsObj[routeId].forEach((obs) => {\n          obs.removed();\n        });\n      });\n      let next = newListHead;\n      while (next) {\n        const observerArray = obsObj[next.id];\n        for (let i = 0; i < observerArray.length; i++) {\n          observerArray[i].inserted(chainData(newListHead, next));\n        }\n        next = next.next;\n      }\n    }\n\n    function insertOrRemove(insert, routeId, data) {\n      let dataToUse = data;\n      if (!isString(routeId) || !IMMUTABLE_GRAPH[routeId]) {\n        return null;\n      }\n      if (data === null || typeof data !== 'object' || data instanceof Array) {\n        dataToUse = emptyObject();\n      }\n      const graph = buildGraph(win.location.hash);\n      let newGraph;\n      if (insert) {\n        newGraph = activateGraphNode(routeId, dataToUse, graph);\n      }\n      else {\n        newGraph = deactivateGraphNode(false, routeId, graph);\n      }\n      win.location.hash = listToHashRoute(graphToList(newGraph));\n      return this;\n    }\n    // End private methods\n\n    // Public methods\n    this.subscribe = function subscribe(subscriptions) {\n      if (!isObject(subscriptions)) {\n        return false;\n      }\n      const matchingKeys = keys(subscriptions).filter(key => !!observers[key]);\n      if (matchingKeys.length === 0) {\n        return false;\n      }\n      matchingKeys.forEach(key => {\n        const sub = subscriptions[key];\n        observers[key].push({\n          inserted: sub.inserted || noop,\n          removed: sub.removed || noop,\n        });\n      });\n      return true;\n    };\n    this.unsubscribe = function unsubscribe(route, event, handler) {\n      if (!isString(route) || !isString(event) || !isFunction(handler) || !observers[route]) {\n        return false;\n      }\n      const matchingObservers = observers[route].filter((obs) => obs[event] === handler);\n      return pull(matchingObservers, observers[route]);\n    };\n    this.insert = function insert(routeId, data) {\n      return insertOrRemove.call(this, true, routeId, data);\n    };\n    this.remove = function remove(routeId) {\n      return insertOrRemove.call(this, false, routeId);\n    };\n    this.getData = function getData() {\n      return chainData(graphToList(buildGraph(win.location.hash)));\n    };\n    this.step = function step() {\n      const originalHash = win.location.hash;\n      const graph = buildGraph(originalHash);\n      notifyObservers(observers, graphStack.pop(), graph);\n      logGraph(graph);\n      win.history.replaceState(emptyObject(), '', listToHashRoute(graphToList(graph)));\n      return this;\n    };\n\n    const listener = this.step.bind(this);\n    this.start = function start() {\n      win.addEventListener('hashchange', listener);\n      return this;\n    };\n    this.stop = function stop() {\n      win.removeEventListener('hashchange', listener);\n      return this;\n    };\n    // End public methods\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/marbles.js","function emptyObject() {\n  return Object.create(null);\n}\n\nfunction isObject(any) {\n  return typeof any === 'object' && any !== null && !(any instanceof Array);\n}\n\nfunction isString(any) {\n  return typeof any === 'string';\n}\n\nfunction isFunction(any) {\n  return typeof any === 'function';\n}\n\nfunction keys(obj) {\n  return Object.keys(obj);\n}\n\nfunction cloneDeep(obj) {\n  return JSON.parse(JSON.stringify(obj));\n}\n\nfunction assign(...args) {\n  return Object.assign.apply(this, args);\n}\n\nfunction arrayHead(array) {\n  if (typeof array === 'undefined' || !(array instanceof Array)) {\n    return undefined;\n  }\n  return array[0];\n}\n\nfunction pull(values, array) {\n  return values.map((val) => {\n    let index = array.indexOf(val);\n    let results = [];\n    while (index !== -1) {\n      results = results.concat(array.splice(index, 1));\n      index = array.indexOf(val);\n    }\n    return results;\n  })\n  .reduce((returnArray, subArray) => returnArray.concat(subArray), [])\n  .reduce((returnArray, val) => {\n    if (returnArray.indexOf(val) !== -1) {\n      return returnArray;\n    }\n    return returnArray.concat(val instanceof Array ? [val] : val);\n  }, []);\n}\n\nfunction without(values, array) {\n  const newArray = array.slice();\n  pull(values, newArray);\n  return newArray;\n}\n\nfunction peek(arr) {\n  if (!arr || !(arr instanceof Array)) {\n    return null;\n  }\n  return arr[arr.length-1] || null;\n}\n\nfunction noop() {}\n\nexport {\n  emptyObject,\n  isObject,\n  isFunction,\n  isString,\n  noop,\n  keys,\n  peek,\n  cloneDeep,\n  assign,\n  arrayHead,\n  pull,\n  without\n};\n\n\n\n// WEBPACK FOOTER //\n// ./src/util.js"],"sourceRoot":""}